<!DOCTYPE html>
<html>

<head>
  <title>Key Focus</title>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/select2.css">
</head>
<style type="text/css">
  .enter-key:focus, .select2-container-active{
    border: 1px solid red !important;
    border-radius:5px;
  }
  .select2-container{
  	width: 100%;
  }
</style>
<body>
  <div class="container">
    <div class="row" id="treeStructure">
      <div class="col-sm-12">
        <table class="table table-bordered" id="focusElement" width="100%">
          <thead>
            <tr>
              <th>FName</th>
              <th>LName</th>
              <th>Mail</th>
              <th>Phone</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="number" class="form-control enter-key">
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="number" class="form-control enter-key">
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <input type="number" class="form-control enter-key">
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-6">
                    <input type="text" class="form-control enter-key">
                  </div>
                   <div class="col-sm-6">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                     <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
            </tr>
            <tr class="hide">
              <td>
                <div class="row">
                  <div class="col-sm-6">
                    <input type="text" class="form-control enter-key">
                  </div>
                   <div class="col-sm-6">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                     <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>
                <div class="row">
                  <div class="col-sm-6">
                    <input type="text" class="form-control enter-key">
                  </div>
                   <div class="col-sm-6">
                    <input type="text" class="form-control enter-key">
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                     <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
               <td>
                <div class="row">
                  <div class="col-sm-12">
                    <select class="enter-key">
                      <option>Select</option>
                    </select>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <script type="text/javascript" src="js/jquery-1.12.4.js"></script>
  <script type="text/javascript" src="js/select2.js"></script>
  <script type="text/javascript">
  	$("select.enter-key").select2();
    var keypressEvent = (function(){
      var Key = {
        LEFT: 37,
        UP: 38,
        RIGHT: 39,
        DOWN: 40
      }
      function moveToNextField(that, position){
        var curntEle = $(that).closest("td").find("input.enter-key"), tdindex = curntEle.get().indexOf(that);
        if(position == "left"){
          curntEle.first().focus()
        }else if(position == "right"){
          curntEle.last().focus();
        }
        return ( curntEle.length -1 ) == tdindex;
      }
      function checkField(inputField){
        if(inputField.hasClass("select2-container")){
          inputField.select2("focus")
        }else{
          inputField.focus();
        }
      }
      function init(){
        $(".enter-key").on("keydown", function(e){
          if(e.keyCode == Key["LEFT"]){
            if(moveToNextField(this, "left")){
              checkField($(this).closest("td").prev().find(".enter-key"));
            }
          }else if(e.keyCode == Key["RIGHT"]){
            if(moveToNextField(this, "right")){
              checkField($(this).closest("td").next().find(".enter-key"));
            }
          }else if(e.keyCode == Key["UP"]){
            var tdIndex = $(this).closest("td").index(), tdCol = $(this).closest("tr").find("td:nth-child("+(tdIndex+1)+") .enter-key").get(), inputIndex = 0;
            if(tdCol.length > 1){
              inputIndex = tdCol.indexOf(this);
            }
            // $($(this).closest("tr").prevAll("tr:not('.hide')").first().find("td:nth-child("+(tdIndex+1)+") .enter-key")[inputIndex]).focus();
            checkField($($(this).closest("tr").prevAll("tr:not('.hide')").first().find("td:nth-child("+(tdIndex+1)+") .enter-key")[inputIndex]));
          }else if(e.keyCode == Key["DOWN"]){
            var tdIndex = $(this).closest("td").index(), tdCol = $(this).closest("tr").find("td:nth-child("+(tdIndex+1)+") .enter-key").get(), inputIndex = 0;
            if(tdCol.length > 1){
              inputIndex = tdCol.indexOf(this);
            }
            checkField($($(this).closest("tr").nextAll("tr:not('.hide')").first().find("td:nth-child("+(tdIndex+1)+") .enter-key")[inputIndex]));
          }
        })
      }
      return{
        initEvent : init
      }
    })();
    keypressEvent.initEvent()
  </script>
</body>

</html>